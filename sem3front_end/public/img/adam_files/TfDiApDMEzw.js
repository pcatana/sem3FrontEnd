if (self.CavalryLogger) { CavalryLogger.start_js(["xMvz3"]); }

__d("AnimatedImageMarauderLogger",["MarauderLogger"],(function a(b,c,d,e,f,g){__p&&__p();function h(){"use strict";__p&&__p();this.$AnimatedImageMarauderLogger1=false;this.$AnimatedImageMarauderLogger2=null;this.$AnimatedImageMarauderLogger3=null;this.$AnimatedImageMarauderLogger4=false;this.$AnimatedImageMarauderLogger5=false;this.$AnimatedImageMarauderLogger6=false;this.$AnimatedImageMarauderLogger7=null;this.$AnimatedImageMarauderLogger8=false;this.$AnimatedImageMarauderLogger9=null;this.$AnimatedImageMarauderLogger10=null;this.$AnimatedImageMarauderLogger11=0;this.$AnimatedImageMarauderLogger12=false}h.prototype.initSession=function(i,j,k,l,m,n){"use strict";this.$AnimatedImageMarauderLogger1=i;this.$AnimatedImageMarauderLogger13=j;this.$AnimatedImageMarauderLogger6=l;this.$AnimatedImageMarauderLogger7=k;this.$AnimatedImageMarauderLogger8=m;this.$AnimatedImageMarauderLogger9=n;this.$AnimatedImageMarauderLogger4=true};h.prototype.hasCurrentSession=function(){"use strict";return this.$AnimatedImageMarauderLogger4};h.prototype.logAnimatedRender=function(i){"use strict";if(this.$AnimatedImageMarauderLogger10&&this.$AnimatedImageMarauderLogger11===0){this.$AnimatedImageMarauderLogger2=i-this.$AnimatedImageMarauderLogger10;this.$AnimatedImageMarauderLogger5=true}};h.prototype.logStaticClick=function(i){"use strict";this.$AnimatedImageMarauderLogger10=i;this.$AnimatedImageMarauderLogger12=true};h.prototype.endSession=function(i){"use strict";if(this.$AnimatedImageMarauderLogger9)this.$AnimatedImageMarauderLogger11=i-this.$AnimatedImageMarauderLogger9;this.$AnimatedImageMarauderLogger4=false;this.logSession()};h.prototype.logSession=function(){"use strict";var i={autoplay:this.$AnimatedImageMarauderLogger1,download_time:this.$AnimatedImageMarauderLogger2,is_video:this.$AnimatedImageMarauderLogger6,image_src:this.$AnimatedImageMarauderLogger7,fbid:this.$AnimatedImageMarauderLogger13,load_succeeded:this.$AnimatedImageMarauderLogger5,plays_inline:this.$AnimatedImageMarauderLogger8,time_spent:this.$AnimatedImageMarauderLogger11,was_tapped:this.$AnimatedImageMarauderLogger12};c("MarauderLogger").log("animated_image_session",undefined,i)};f.exports=h}),null);
__d("FeedAnimatedImageShare.react",["cx","AnimatedImageMarauderLogger","DOMContainer.react","Event","Image.react","OnVisible.react","React","ReactDOM","ReactTransitionEvents","SubscriptionsHandler","VideoPlayerReason"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes,l=20;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){__p&&__p();var n,o;"use strict";for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={disableAutoplay:false,hasPlayedAtleastOnce:false,isLoaded:false,isLoading:false,isPlaying:false,wasPlaying:false},this.$FeedAnimatedImageShare1=null,this.$FeedAnimatedImageShare4=function(){this.setState({disableAutoplay:true});if(!this.props.isPlayableInline){window.open(this.props.href,"_blank");return}if(this.state.isPlaying)this.pause(c("VideoPlayerReason").USER);else this.play(c("VideoPlayerReason").USER)}.bind(this),this.$FeedAnimatedImageShare6=function(){this.$FeedAnimatedImageShare10();if(!this.state.isPlaying&&this.props.isPlayableInline&&(this.$FeedAnimatedImageShare7()||this.state.wasPlaying))this.play(this.state.wasPlaying?c("VideoPlayerReason").PAGE_VISIBILITY:c("VideoPlayerReason").AUTOPLAY)}.bind(this),this.$FeedAnimatedImageShare5=function(){this.$FeedAnimatedImageShare11();this.setState({wasPlaying:this.state.isPlaying});if(this.state.isPlaying)this.pause(c("VideoPlayerReason").PAGE_VISIBILITY)}.bind(this),this.play=function(s){this.$FeedAnimatedImageShare2.logStaticClick(Date.now());this.setState({isPlaying:true});if(this.props.videoController){if(!this.state.hasPlayedAtleastOnce)this.setState({hasPlayedAtleastOnce:true});this.props.videoController.play(s)}else this.$FeedAnimatedImageShare8()}.bind(this),o}m.prototype.componentDidMount=function(){"use strict";this.$FeedAnimatedImageShare2=new(c("AnimatedImageMarauderLogger"))();if(this.refs.playButton)c("ReactTransitionEvents").addEndEventListener(c("ReactDOM").findDOMNode(this.refs.playButton),this.play);this.$FeedAnimatedImageShare3()};m.prototype.$FeedAnimatedImageShare3=function(){"use strict";if(!this.props.videoController||!this.refs.videoPlayer)return;c("ReactDOM").findDOMNode(this.refs.videoPlayer).addEventListener("click",this.$FeedAnimatedImageShare4);this.props.videoController.addListener("finishPlayback",function(){window.setTimeout(function(){this.props.videoController.play(c("VideoPlayerReason").LOOP)}.bind(this),1)}.bind(this));this.$FeedAnimatedImageShare1=new(c("SubscriptionsHandler"))();this.$FeedAnimatedImageShare1.addSubscriptions(c("Event").listen(window,"blur",this.$FeedAnimatedImageShare5),c("Event").listen(window,"focus",this.$FeedAnimatedImageShare6))};m.prototype.componentWillUnmount=function(){"use strict";if(this.$FeedAnimatedImageShare1)this.$FeedAnimatedImageShare1.release()};m.prototype.$FeedAnimatedImageShare7=function(){"use strict";return this.props.autoplay&&!this.state.disableAutoplay};m.prototype.$FeedAnimatedImageShare8=function(){"use strict";if(this.state.isLoading)return;this.setState({isLoading:true});var n=new Image();n.onload=function(){this.setState({hasPlayedAtleastOnce:true,isLoaded:true,isLoading:false});this.$FeedAnimatedImageShare2.logAnimatedRender(Date.now())}.bind(this);n.src=this.props.animatedSrc};m.prototype.$FeedAnimatedImageShare9=function(){"use strict";if(this.props.disableClickToPlayButton)return null;var n=this.props.isPlayableInline&&(!this.state.isPlaying||this.state.isLoading),o=this.state.isLoading,p=!this.state.hasPlayedAtleastOnce&&this.state.isLoaded;return c("React").createElement("div",{className:!n?"hidden_elem":"",onClick:this.$FeedAnimatedImageShare4,role:"presentation"},c("React").createElement("div",{ref:"playButton",className:"_393-"+(p?" _30a":"")}),c("React").createElement("div",{className:"_30b"+(o?" _30c":"")+(p?" _30e":"")}),c("React").createElement("div",{className:"_30h"+(p?" _30i":"")}))};m.prototype.$FeedAnimatedImageShare10=function(){"use strict";this.$FeedAnimatedImageShare2.initSession(this.props.autoplay,this.props.fbid,this.props.href,this.props.isPlayableInline,!!this.props.videoController,Date.now())};m.prototype.$FeedAnimatedImageShare11=function(){"use strict";if(this.$FeedAnimatedImageShare2&&this.$FeedAnimatedImageShare2.hasCurrentSession())this.$FeedAnimatedImageShare2.endSession(Date.now())};m.prototype.$FeedAnimatedImageShare12=function(){"use strict";if(!this.props.staticSrc)return null;return c("React").createElement(c("Image.react"),{className:"_9_m _30j",src:this.props.staticSrc,width:this.props.width,height:this.props.height,onClick:this.$FeedAnimatedImageShare4})};m.prototype.$FeedAnimatedImageShare13=function(){"use strict";return c("React").createElement(c("Image.react"),{className:"_9_m",src:this.props.animatedSrc,width:this.props.width,height:this.props.height,onClick:this.$FeedAnimatedImageShare4})};m.prototype.$FeedAnimatedImageShare14=function(){"use strict";if(!this.state.isPlaying||!this.state.isLoaded||!this.props.isPlayableInline)return this.$FeedAnimatedImageShare12();return this.$FeedAnimatedImageShare13()};m.prototype.$FeedAnimatedImageShare15=function(){"use strict";if(!this.props.videoElement)return null;return c("React").createElement("span",null,c("React").createElement("span",{className:!this.state.hasPlayedAtleastOnce?"hidden_elem":""},c("React").createElement(c("DOMContainer.react"),{ref:"videoPlayer"},this.props.videoElement)),c("React").createElement("span",{className:this.state.hasPlayedAtleastOnce?"hidden_elem":""},this.$FeedAnimatedImageShare12()))};m.prototype.$FeedAnimatedImageShare16=function(){"use strict";if(this.state.isPlaying||!this.props.overlay)return null;return c("React").createElement(c("DOMContainer.react"),null,this.props.overlay)};m.prototype.pause=function(n){"use strict";this.setState({isPlaying:false});if(this.props.videoController)this.props.videoController.pause(n)};m.prototype.render=function(){"use strict";var n=-1*(this.props.height*l/100);return c("React").createElement(c("OnVisible.react"),{onVisible:this.$FeedAnimatedImageShare6,onHidden:this.$FeedAnimatedImageShare5,buffer:n},c("React").createElement("div",null,this.$FeedAnimatedImageShare15()||this.$FeedAnimatedImageShare14(),this.$FeedAnimatedImageShare9(),this.$FeedAnimatedImageShare16()))};m.propTypes={animatedSrc:k.string,autoplay:k.bool,fbid:k.string,height:k.number.isRequired,href:k.string,isPlayableInline:k.bool,overlay:k.object,staticSrc:k.string,videoController:k.object,videoElement:k.object,width:k.number.isRequired,disableClickToPlayButton:k.bool};m.defaultProps={autoplay:false,isPlayableInline:false};f.exports=m}),null);